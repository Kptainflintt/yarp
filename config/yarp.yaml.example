# Configuration YARP - Exemple Simple
system:
  hostname: test-router
  domain: lab.local       # Appliqué dans /etc/resolv.conf (domain + search) et /etc/hosts (FQDN)
  timezone: Europe/Paris  # Appliqué via /etc/localtime et /etc/timezone (nécessite tzdata)
  dns_servers:            # Serveurs DNS écrits dans /etc/resolv.conf (nameserver)
    - 1.1.1.1
    - 8.8.8.8

# Configuration des logs
logging:
  # Niveau de logs: DEBUG, INFO, WARNING, ERROR
  level: INFO

  # Mode debug activé par défaut pour voir plus de détails
  debug: false

  # Logs dans les fichiers
  files:
    # Log principal de l'application
    application: "/var/log/yarp/apply.log"
    # Log détaillé pour debug (si debug: true)
    debug: "/var/log/yarp/debug.log"
    # Log des erreurs uniquement
    error: "/var/log/yarp/error.log"

  # Formats de logs
  formats:
    # Format console (ce que voit l'utilisateur)
    console: "simple"  # simple, detailed, minimal
    # Format fichier (logs structurés)
    file: "json"       # json, text, detailed

  # Modules spécialisés
  modules:
    network: INFO      # Logs networking
    routing: INFO      # Logs routing
    dns: INFO          # Logs DNS (resolv.conf)
    firewall: WARNING  # Logs firewall (moins verbeux par défaut)

interfaces:
  # Interface WAN (vers Internet)
  eth0:
    description: "Interface WAN"
    ipv4: dhcp
    zone: WAN
    # Configuration NAT masquerading
    masquerading: true
    masquerade_sources:
      - "192.168.1.0/24"     # Réseau LAN principal
      - "10.0.0.0/24"        # Réseau supplémentaire

  # Interface LAN (réseau local)
  eth1:
    description: "Interface LAN"
    ipv4: 192.168.1.1/24
    ipv6: fd00:1::1/64
    zone: LAN

routing:
  static:
    # Route par défaut vers le WAN
    - to: 0.0.0.0/0
      via: 192.168.100.1
      interface: eth0

    # Route vers un sous-réseau spécifique
    - to: 10.0.0.0/24
      via: 192.168.1.254
      metric: 10

firewall:
  default:
    input: drop
    forward: drop
    output: accept
  stateful: true
  rules: []
